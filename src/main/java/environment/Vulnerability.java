package environment;

import java.io.Serializable;
import java.util.Objects;

public class Vulnerability implements Serializable {
    private String cve = "";
    private Vulnerability.TYPE type;
    private boolean isZeroday;
    private Exploit exploit;
    public enum TYPE {
        REMOTE_CODE_EXECUTION,
        PRIVILEGE_ESCALATION,
        CODE_INJECTION,
        //CREDENTIAL_LEAK,
        BYPASS_AUTHORIZATION
    }

    public boolean getZeroday() {
        return isZeroday;
    }

    public String getCve() {
        return cve;
    }

    public TYPE getType() {
        return type;
    }

    public Vulnerability(String cve, TYPE type, boolean isZeroday) {
        this.cve = cve;
        this.type = type;
        this.isZeroday = isZeroday;
        this.exploit = new Exploit(type);
    }

    public Exploit.TYPE getExploitType(){
        return exploit.getType();
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof Vulnerability)) return false;
        Vulnerability that = (Vulnerability) o;
        return Objects.equals(cve, that.cve) &&
                Objects.equals(type, that.type) &&
                Objects.equals(isZeroday, that.isZeroday) &&
                Objects.equals(exploit, that.exploit);
    }

    @Override
    public int hashCode() {

        return Objects.hash(cve, type, isZeroday, exploit);
    }
}
